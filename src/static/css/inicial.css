:root{
  /* Paleta IST + acentos vivos */
  --ist-purple:#552789;
  --ist-purple-dk:#3e1a66;
  --ink:#0f172a;
  --muted:#8b86a3;
  --panel:#ffffff;
  --soft:#f6f7fb;
  --border:#e5e7eb;

  /* Estados */
  --ok:#16a34a;
  --warn:#d97706;
  --risk:#dc2626;

  /* Chips generales */
  --chip-bg:#f7f2ff;
  --chip-br:#e9dcff;

  /* Acentos por factor */
  --rep:#dc2626;   --rep-bg:#fee2e2;     /* Repetitivo */
  --post:#2563eb;  --post-bg:#e8f0ff;    /* Postura */
  --lev:#059669;   --lev-bg:#e7fff5;     /* Levantamiento/Descenso */
  --push:#ea580c;  --push-bg:#fff0e6;    /* Empuje/Arrastre */
  --pcts:#db2777;  --pcts-bg:#ffe6f1;    /* PCTS */
  --vcc:#dc2626;   --vcc-bg:#fee2e2;     /* Vib cuerpo completo */
  --vhb:#0ea5e9;   --vhb-bg:#e6f6ff;     /* Vib mano-brazo */

  /* Diseño */
  --radius:14px;
  --radius-sm:10px;
  --shadow-sm:0 6px 16px rgba(16,24,40,.10);
  --shadow-md:0 10px 24px rgba(16,24,40,.14);
}

/* ===== Base & Navbar ===== */
html,body{height:100%;}
body{
  background:var(--soft);
  color:var(--ink);
  -webkit-font-smoothing:antialiased;
  -moz-osx-font-smoothing:grayscale;
  text-rendering:optimizeLegibility;
}
.small,.text-muted{color:var(--muted);}

:focus-visible{
  outline:3px solid color-mix(in srgb, var(--ist-purple) 30%, #fff 70%);
  outline-offset:2px;
  border-radius:8px;
}

.ist-navbar{background:var(--ist-purple-dk);}
.ist-navbar .navbar-brand{display:inline-flex;align-items:center;gap:.5rem;padding:.25rem 0;}
.ist-navbar .navbar-brand img{height:36px;display:block;}
.ist-navbar .nav-link{color:#fff;}
.ist-navbar .nav-link:hover,.ist-navbar .nav-link:focus-visible{color:#f2e9ff;}

/* Botón primario con paleta IST */
.btn-primary{
  background:var(--ist-purple);
  border-color:var(--ist-purple);
}
.btn-primary:hover{background:var(--ist-purple-dk);border-color:var(--ist-purple-dk);}
.btn-primary:focus-visible{
  box-shadow:0 0 0 0.2rem color-mix(in srgb, var(--ist-purple) 35%, #fff 65%);
}

/* ===== Tarjetas (1 por fila) ===== */
#cardsWrap > .col{width:100%;}

.card-ficha{
  position:relative;
  background:var(--panel);
  border:1px solid var(--border);
  border-radius:var(--radius);
  overflow:hidden;
  transition:transform .14s ease, box-shadow .14s ease, border-color .14s ease;
  box-shadow:var(--shadow-sm);
}
.card-ficha:hover{
  transform:translateY(-2px);
  box-shadow:var(--shadow-md);
  border-color:#dfe3ea;
}
.card-ficha .card-body{padding:1.1rem 1.1rem 1rem;}
.card-ficha .title{margin:0;line-height:1.2;color:var(--ist-purple);}

/* Acento lateral por estado (opcional si tu JS setea data-state) */
.card-ficha::before{
  content:"";position:absolute;inset:0 auto 0 0;width:6px;background:#e5e7eb;
}
.card-ficha[data-state="ok"]::before{background:rgba(22,163,74,.95);}
.card-ficha[data-state="warn"]::before{background:rgba(217,119,6,.95);}
.card-ficha[data-state="bad"]::before{background:rgba(220,38,38,.95);}
.card-ficha[data-state="unk"]::before{background:#cbd5e1;}

/* Hr suave dentro de tarjetas */
.card-ficha hr{margin:.75rem 0 1rem;border-color:var(--border);opacity:.55;}

/* ===== Chips / Pills ===== */
.chip{
  display:inline-flex;align-items:center;gap:.35rem;
  background:var(--chip-bg);border:1px solid var(--chip-br);color:var(--ist-purple);
  padding:.25rem .55rem;border-radius:999px;font-size:.8rem;white-space:nowrap;font-weight:700;
}

.pill{
  display:inline-flex;align-items:center;gap:.45rem;
  padding:.375rem .7rem;border-radius:10px;font-size:.86rem;background:#f8fafc;border:1px solid var(--border);
  font-weight:700; line-height:1;
}
.pill i{font-size:1rem;}

/* ====== Compatibilidad: colores “Vigente / Vencido / Próximo” ====== */
#areasList .pill.pill-ok{
  background:rgba(22,163,74,.12);
  color:var(--ok);
  border-color:rgba(22,163,74,.25);
}
#areasList .pill.pill-bad{
  background:rgba(220,38,38,.12);
  color:var(--risk);
  border-color:rgba(220,38,38,.25);
}
#areasList .pill.pill-warn{
  background:rgba(217,119,6,.12);
  color:var(--warn);
  border-color:rgba(217,119,6,.25);
}
#areasList .pill.pill-na{
  background:#f3f4f6;color:#374151;border-color:#e5e7eb;
}
.status-vigente{background:rgba(22,163,74,.12);color:var(--ok);border:1px solid rgba(22,163,74,.25);}
.status-vencido{background:rgba(220,38,38,.12);color:var(--risk);border:1px solid rgba(220,38,38,.25);}
.status-proximo{background:rgba(217,119,6,.12);color:var(--warn);border:1px solid rgba(217,119,6,.25);}

/* ===== Estado textual dentro de la tarjeta ===== */
.status-pill{
  display:inline-flex;align-items:center;gap:.4rem;
  padding:.4rem .7rem;border-radius:999px;font-weight:800;font-size:.92rem;border:1px solid transparent;
}
.status-pill i{font-size:1.05rem;line-height:1;}
.status-ok{color:#065f46;background:#ecfdf5;border-color:#a7f3d0;}
.status-warn{color:#7c2d12;background:#fff7ed;border-color:#fed7aa;}
.status-bad{color:#7f1d1d;background:#fef2f2;border-color:#fecaca;}
.status-unk{color:#334155;background:#f1f5f9;border-color:#e2e8f0;}

/* ===== Fila meta (row g-2 small movida arriba) ===== */
.card-ficha .row.g-2.small{
  --bs-gutter-x:.65rem;
  --bs-gutter-y:.55rem;
  margin-bottom:.75rem;
}
.card-ficha .row.g-2.small .col-6{
  display:flex;align-items:center;gap:.4rem;
  padding:.4rem .55rem;border:1px dashed #eef1f5;border-radius:var(--radius-sm);
  background:#fcfdff;
}

/* ===== Factores dentro de la tarjeta ===== */
.factors-wrap{
  display:flex;flex-wrap:wrap;gap:.45rem;
  padding:.1rem 0;
}
.factor-chip{
  display:inline-flex;align-items:center;gap:.4rem;
  padding:.35rem .55rem;border-radius:999px;font-weight:800;font-size:.82rem;
  border:1px solid transparent;background:#f8fafc;color:#334155;
}
.factor-chip .state{
  display:inline-flex;align-items:center;justify-content:center;
  min-width:1.25rem;height:1.25rem;border-radius:50%;font-size:.72rem;font-weight:900;color:#fff;
}

/* Colores por factor */
.f-rep{ --accent:var(--rep);  --bg:var(--rep-bg); }
.f-post{--accent:var(--post); --bg:var(--post-bg); }
.f-lev{ --accent:var(--lev);  --bg:var(--lev-bg);  }
.f-push{--accent:var(--push); --bg:var(--push-bg); }
.f-pcts{--accent:var(--pcts); --bg:var(--pcts-bg); }
.f-vcc{ --accent:var(--vcc);  --bg:var(--vcc-bg);  }
.f-vhb{ --accent:var(--vhb);  --bg:var(--vhb-bg);  }

/* Variantes SI/NO (chips de factores) */
.factor-chip.is-yes{
  background:var(--bg);
  border-color:color-mix(in srgb, var(--accent) 30%, #fff 70%);
  color:color-mix(in srgb, var(--accent) 80%, #000 20%);
}
.factor-chip.is-yes .state{ background:var(--accent); }
.factor-chip.is-no { background:#fff; border-color:#e5e7eb; color:#64748b; }
.factor-chip.is-no .state{ background:#94a3b8; }

/* Títulos “Tabla II / VI” (usa w-100 + small + text-muted en tu HTML) */
.card-ficha .w-100.small.text-muted{
  text-transform:uppercase;letter-spacing:.02em;font-weight:800;margin-top:.25rem;
  color:color-mix(in srgb, var(--ist-purple) 34%, var(--muted) 66%);
}

/* ===== Barra inferior (paginación “slide”) ===== */
.bottom-sticky{
  position:sticky;bottom:0;z-index:5;background:var(--panel);
  border:1px solid var(--border);border-radius:12px;
  box-shadow:0 -8px 20px rgba(16,24,40,.06);
  backdrop-filter:saturate(1.1) blur(6px);
}

/* ===== Modal fullscreen (detalle) ===== */
.modal-fullscreen .modal-header{border-bottom:1px solid var(--border);}
.modal-fullscreen .modal-footer{border-top:1px solid var(--border);}
#detailBody{display:grid;gap:1rem;}
@media (min-width:992px){ #detailBody{grid-template-columns:1fr;} }

.detail-card{
  border:1px solid var(--border);
  border-radius:12px;
  background:#fff;
  padding:1rem;
  box-shadow:var(--shadow-sm);
}

/* Bloques de estado P (Aceptable) y W (Crítica) */
.hl-ok   { background:linear-gradient(0deg, rgba(22,163,74,.10), rgba(22,163,74,.10)); border:1px solid rgba(22,163,74,.25); border-radius:.85rem; }
.hl-warn { background:linear-gradient(0deg, rgba(217,119,6,.12), rgba(217,119,6,.12)); border:1px solid rgba(217,119,6,.25); border-radius:.85rem; }
.hl-risk { background:linear-gradient(0deg, rgba(220,38,38,.12), rgba(220,38,38,.12)); border:1px solid rgba(220,38,38,.28); border-radius:.85rem; }
.state-card{ padding:.85rem 1rem; }
.state-card .sc-head{ font-weight:900; margin-bottom:.25rem; display:flex; align-items:center; gap:.45rem; }
.hl-ok  .sc-head{ color:var(--ok); }
.hl-warn .sc-head{ color:var(--warn); }
.hl-risk .sc-head{ color:var(--risk); }

/* Tabla legible con thead sticky */
.table-like{border:1px solid var(--border);border-radius:12px;overflow:auto;background:#fff;}
.table-like table{width:100%;border-collapse:separate;border-spacing:0;}
.table-like th,.table-like td{padding:.65rem .8rem;border-bottom:1px solid #f1f5f9;vertical-align:top;}
.table-like thead th{position:sticky;top:0;background:#f8fafc;z-index:1;font-weight:800;}
.table-like tbody tr:nth-child(odd) td{background:#fcfcff;}

/* ===== Panel derecho: Cuestionarios por Área ===== */
#areasList .area-block{border:1px solid #eee;border-radius:.9rem;background:#fff;padding:.85rem;margin-bottom:.9rem;box-shadow:var(--shadow-sm);}
#areasList .area-head{display:flex;justify-content:space-between;align-items:center;gap:.5rem;flex-wrap:wrap;}
#areasList .area-head h6{color:var(--ist-purple);margin:0;}
#areasList .puesto-btn{
  width:100%;text-align:left;background:#faf9ff;border:1px solid #eee;border-radius:.6rem;
  padding:.6rem .75rem;display:flex;justify-content:space-between;align-items:center;gap:.5rem;
  transition:background .12s ease, transform .12s ease, box-shadow .12s ease;
}
#areasList .puesto-btn:hover{background:#f3f1ff;transform:translateY(-1px);box-shadow:0 6px 14px rgba(16,24,40,.10);}
#areasList .person-row{
  display:flex;justify-content:space-between;align-items:center;
  padding:.45rem .25rem;border-bottom:1px dashed #eee;font-size:.95rem;
}
#areasList .person-row:last-child{border-bottom:0;}

/* ===== Marcas pequeñas ===== */
.m-dot{width:.6rem;height:.6rem;border-radius:50%;display:inline-block;}
.m-ok{background:var(--ok);} .m-warn{background:var(--warn);} .m-risk{background:var(--risk);}

/* ===== Ajustes responsivos ===== */
@media (max-width: 575.98px){
  .card-ficha .title{font-size:1.05rem;}
  .chip{font-size:.78rem;}
  .factor-chip{font-size:.8rem;}
  .status-pill{font-size:.88rem;}
}

/* ===== Preferencias del sistema ===== */
@media (prefers-reduced-motion: reduce){
  *{transition:none !important; animation:none !important;}
}

.table-like tbody tr.is-aceptable-ok > th,
.table-like tbody tr.is-aceptable-ok > td{
  background:#ecfdf5 !important;   /* verde suave */
  color:#065f46;
  box-shadow: inset 4px 0 0 0 var(--ok);
}

.table-like tbody tr.is-aceptable-bad > th,
.table-like tbody tr.is-aceptable-bad > td{
  background:#fef2f2 !important;   /* rojo suave */
  color:#7f1d1d;
  box-shadow: inset 4px 0 0 0 var(--risk);
}

/* Nota del requerimiento: ambas variantes de “Crítica” en amarillo */
.table-like tbody tr.is-critica > th,
.table-like tbody tr.is-critica > td{
  background:#fff7ed !important;   /* amarillo suave */
  color:#7c2d12;
  box-shadow: inset 4px 0 0 0 var(--warn);
}